<script>
    function BidderProfile(){
      this.profileData;
  
      this.mainSetup = () =>{
          new TabNavigation('.tab-navigation-btns','button','.tab-navigation-pages','.nav-page');
          this.getProfileData();
          this.manageBasicDetails();
      }
  
      this.getProfileData = async () =>{
          var reqdata = new FormData();
              reqdata.append('ACT','srch')
          var reqs = await sendHttpRequest('usermanage/api/usrprfl',reqdata);
  
          this.profileData = reqs.Record; 
          this.printPorfileData(this.profileData);
      }
  
      this.printPorfileData = (profiledata) =>{
          
          var textkeys = Array.from(document.querySelectorAll('.text-keys'));
          
          for(var key in profiledata){
              var span = textkeys.find(textkey=>textkey.dataset.key === key)
                  if(span){
                      span.textContent = profiledata[key]
                  }
          }
  
          if(profiledata.status ==='M'){
  
          }
  
          this.renderCommodities(profiledata.comdty)
          // renderQuestions(profiledata)
          // printLinks(JSON.parse(profiledata['file.nms']));
          // printConvertData(profiledata);
          // document.getElementById('pr_input').value = profiledata['pr.no'];
      }
  
      // Manage Basic Details
      this.manageBasicDetails = () =>{
          $('#aio-updt').click(this.updateAreaOfItrst);
      }
  
      
  
      this.renderCommodities = async (purchaseComData) =>{
  
          this.comWrapper = document.querySelector('#area-of-intrest');
          var reqData = new FormData();
              reqData.append('act', 'getCommodities')
          var resp = await sendHttpRequest('eaucnmanage/clintsettings', reqData);
  
          await resp.Records.forEach(element => {
              console.log(element);
              this.comWrapper.innerHTML+=`
                  <div class="col-lg-2" >
                      <input type='checkbox' value="${element.CMDTYID}" class="comodity" data-comid="${element.CMDTYID}">
                      <label>${element.CMDT_NME}</label>
                  </div>`;
          });
  
  
          var commodityCheck = Array.from(this.comWrapper.querySelectorAll('.comodity'));
  
          purchaseComData.split(",").forEach((comid)=>{
              var check = commodityCheck.find((checkInput) => checkInput.dataset.comid === comid);
              check.checked = true;
          });
  
          // console.log("purchaseComData",purchaseComData);
      }
  
      this.updateAreaOfItrst = async () =>{
          var reqdata = new FormData();
          var checkBoxes = Array.from( this.comWrapper.querySelectorAll(".comodity")); 
          var area =  '';
  
          checkBoxes.forEach(check=>{
              if(check.checked){
                  area += check.value + ",";
              }
          })
          
  
          reqdata.append('comdty',area.slice(0,-1));
          reqdata.append('pr.no',this.profileData['pr.no']);
          reqdata.append('ACT','cmdtyupdt');
  
          await sendHttpRequest('usermanage/api/usrprfl', reqdata);
  
      }
  
      this.sentEmailOtp = () =>{
          if(emailInput.value !== ''){
              var reqdata = new FormData();
                  reqdata.append('act','sndotp');
                  reqdata.append('cntc',emailInput.value);
                  reqdata.append('usr.login',profileData['usr.login']);
              sendReq(reqdata)
          }else{
              alert("Please Enter Valid Email ID!");
          }
      }
  
      this.updateEmail = () =>{
  
      }
  
      // End Manage Basic Details
  
      // Login And Security
      // End Login And Security
  
      // Manage Account Details
      // End Account Details
  
      // Manage Settings
      this.manageSettings = () =>{
          
      }
      // End Setting
  
      // Uploaded Documents
      // End Uploaded Documents
  
  
  
      this.mainSetup();
    }
  
    new BidderProfile()
  </script>
  <style>
      .purchaser-profile-page .btn-wrapper{
          /* background-color: red; */
          padding-left: 2px;
          padding-top: 10px;
          padding-bottom: 5px;
          box-shadow: 0px 4px 9px -5px #003acd;
          background-color: #fff;
      }
  
      .purchaser-profile-page  .btn-wrapper button{
          /* height: 35px !important; */
      }
  
      .purchaser-profile-page  .btn-wrapper button .icon{
          height: 35px !important;
      }
  
      .purchaser-profile-page  h5{
          margin-top: 7px;
          /* margin-bottom: 10px !important; */
      }
  
  
      .purchaser-profile-page  .sub-heading{
          font-weight: 600;
          color: rgb(6, 9, 165);
          margin-top: 10px;
          margin-bottom: 7px;
      }
  
      .purchaser-profile-page .shadow-div{
          /* background-color: red ; */
          box-shadow: 0px 0px 7px 4px rgba(0,0,0,0.1);
          border-radius: 5px;
          border-radius: 10px;
          padding-left: 5px;
      }
  
      .purchaser-profile-page .shadow-div .sub-heading{
          margin-top: 0px !important;
          font-size: 14px;
      }
  
  
      .purchaser-profile-page  #area-of-intrest label{
          font-size: 12px !important;
          font-weight: 600;
      }
  
      .purchaser-profile-page  #aio-updt{
          margin-top: 16px;
          margin-bottom: 10px;
      }
  
      .purchaser-profile-page  .text-heading{
          text-align: right;
          font-size: 12px;
          line-height: 20px;
          font-weight: 600;
      }
  
      .purchaser-profile-page .text-keys{
          font-weight: 600;
          color: var(--blue);
          font-size: 12px;
      }
  
  
      .purchaser-profile-page  .edit{
          font-size: 20px;
          cursor: pointer;
          font-weight: bold !important;
          opacity: 0.7;
      }
  
      .purchaser-profile-page .edit:hover{
          opacity: 1;
          color: var(--blue);
          font-weight: 1000 !important;
      }
  
      .gst-pan-wrapper{
          border-radius: 5px;
          padding: 10px 5px;
          box-shadow: 0px 0px 7px 5px rgba(0,0,0,0.1);
          margin-left: 2px;
      }
  
      .ac-heading{
          font-weight: 600;
          font-size: 15px;
      }
  </style>
  
  <div class="purchaser-profile-page">
      
      <div class="row header" style="width:100%;">
          <div class="col-5 m-auto">
            <h4 class="text-center">
              <span class="heading"><strong>Profile</strong></span>
              <span class="icon">
                  <i class="fa-solid fa-id-badge"></i>
              </span>
            </h4>
            <hr>
          </div>
      </div>
      
      
      <section>
      
          <div class="btn-wrapper tab-navigation-btns">
              <button class="custome-icon-btn-primary"          data-page="basic-details">
                  <span class="icon"><i class="fa-solid fa-circle-info"></i></span>
                  <span class="text"> Basic Details</span>
              </button>
              <button class="custome-icon-btn-outline-primary"  data-page="login-security">
                  <span class="icon"><i class="fa-solid fa-shield-halved"></i></span>
                  <span class="text"> Login And Security</span>
              </button>
              <button class="custome-icon-btn-outline-primary"  data-page="acc-details"  data-active="true" >
                  <span class="icon"><i class="fa-solid fa-building-columns"></i></span>
                  <span class="text">Account Details</span>
              </button>
              <button class="custome-icon-btn-outline-primary"  data-page="setting">
                  <span class="icon"><i class="fa-solid fa-gear"></i></span>
                  <span class="text"> Settings</span>
              </button>
              <button class="custome-icon-btn-outline-primary"  data-page="upld-docs">
                  <span class="icon"><i class="fa-solid fa-file"></i></span>
                  <span class="text"> Uploaded Documents</span>
              </button>
          </div>
      
          <div class="tab-navigation-pages">
              <div id="basic-details" class="nav-page" data-page="basic-details">
                  <h5><u>Basic Details:</u></h5>
      
                 
                  <div class="shadow-div">
                      <div class="col-12">
                          <div class="sub-heading"><u>Update Area Of Intrest:</u></div>
                          <div class="row" id="area-of-intrest" style="width: 100%;"></div>
                          <button class="custome-icon-btn-primary" type="submit" id="aio-updt">
                              <span class="text">Update</span>
                          </button>
                      </div>
                  </div>
      
                  <div class="shadow-div mt-3">
                      <div class="row" style="width: 100%;">
                          <div class="col-8">
                              <div class="sub-heading"><u>Your Basic Details:</u></div>
                              <div class="row">
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Firm Registration Name:</p>
                                          </div>
                                          <div class="col-lg-6"><span class="text-keys" data-key="purchaser.nm"></span></div>
                                      </div>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Authority First Name:</p>
                                          </div>
                                          <div class="col-lg-6"><span class="text-keys" data-key="purchaser.fnm"></span></div>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Last Name:</p>
                                          </div>
                                          <div class="col-lg-6"><span class="text-keys" data-key="purchaser.lnm"></span></div>
                                      </div>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Identy No:</p>
                                          </div>
                                          <div class="col-lg-6"><span class="text-keys" data-key="id.no"></span></div>
                                      </div>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Gender:</p>
                                          </div>
                                          <div class="col-lg-6"><span class="text-keys" data-key="gndr"></span></div>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">DOB:</p>
                                          </div>
                                          <div class="col-lg-6"><span class="text-keys" data-key="dob"></span></div>
                                      </div>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Mobile:</p>
                                          </div>
                                          <div class="col-lg-6">
                                              <span class="text-keys" data-key="mob.no"></span>
                                              <span  id="show-edit-contact">
                                                  <i class="fa-solid fa-pen-to-square"></i>
                                              </span >
                                              
                                              <div class="row">
                                                  <div class="col-12 d-none">
                                                      <form id="new-contact" class="needs-validation  hide" novalidate>
                                                          <HR></HR>
                                                          <div class="input-group mb-3">
                                                              <input type="number" class="form-control"  name="cntc" id="contact-no" required placeholder="Enter New Mo." aria-label="Enter New Mo." aria-describedby="sent-phone-otp">
                                                              <span class="input-group-text bg-success text-white mobile-otp-btn" id="sent-phone-otp">OPT</span>
                                                          </div>
                                                          <input type="number" class="form-control" name="otp" placeholder="Enter OTP" required>
                                                          <button class="btn btn-primary mt-1">Submit</button>
                                                      </form>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="row">
                                          <div class="col-lg-6">
                                              <p class="text-heading">Email:</p>
                                          </div>
                                          <div class="col-lg-6">
                                              <span class="text-keys" data-key="email.id"></span>
                                              <span id="show-edit-email" class="edit">
                                                  <i class="fa-solid fa-pen-to-square"></i>
                                              </span >
                                              <div class="row">
                                                  <div class="col-12">
                                                      <div class="col-12">
                                                          <form id="new-email" class="needs-validation  hide" novalidate>
                                                              <HR></HR>
                                                              <div class="input-group mb-3">
                                                                  <input type="email" id="contact-email" name="cntc"   required class="form-control" placeholder="Email" aria-label="Email" aria-describedby="opt-emain">
                                                                  <span class="input-group-text bg-success text-white email-otp-btn" id="send-otp-email">OTP</span>
                                                              </div>
                                                              <input type="text" class="form-control" name="otp" placeholder="Enter OTP" required>
                                                              <button class="btn btn-primary mt-1">Submit</button>
                                                          </form>
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
      
              <div id="login-security" class="nav-page" data-page="login-security">
                  <h5><u>Login & Security:</u></h5>
      
                  <div class="col-lg-12">
                      <div class="row" style="width: 100%;">
                          <div class="col-12">
                              <p class="">Username: <span class="text-keys" data-key="usr.login"></span></p>
                          </div>
                      </div>
                  </div>
      
                  <form id="change-password-ans" class="needs-validation col-5 template-form" novalidate>
                      <div class="row" style="width: 100%;">
                          <div class="input-row row">
                              <div class="col-4 form-label">
                                  <label for="new_pwd" >New Password:</label>
                              </div>
                              <div class="col-8">
                                  <input type="password" required id="pwd" placeholder="" name="usr.pwd" aria-label="newpwd" aria-describedby="newpwd">
                                  <!-- <span class="input-group-text show-pwd" id="newpwd">
                                      <i class="pe-7s-look"> </i>
                                  </span> -->
                              </div>
                          </div>
                          <div class="input-row row">
                              <div class="col-4 form-label">
                                  <label for="ans1">Confirm Password:</label>
                              </div>
                              <div class="col-8">
                                  <input required type="password"  id="confrmpwd" aria-label="oldpwd" aria-describedby="oldpwd">
                              </div>
                          </div>
                          <div class="input-row row">
                              <div class="col-4 form-label">
                                <label for="">Answer 1:</label>
                              </div>
                              <div class="col-8">
                                  <input required type="text" id="ans1" name="ans1" placeholder="Write Your Answer"  aria-label="oldpwd" aria-describedby="oldpwd">
                              </div>
                          </div>
                          <div class="input-row row">
                              <div class="col-4 form-label">
                                <label for="">Answer 2:</label>
                              </div>
                              <div class="col-8">
                                  <input required type="text" id="ans2" name="ans2" placeholder="Write Your Answer"  aria-label="oldpwd" aria-describedby="oldpwd">
                              </div>
                          </div>
                          <div class="input-row row">
                              <div class="col-4"></div>
                              <div class="col-8">
                                  <div class="input-row row">
                                      <div class="col-8"><input required type="number" id="otp-inpt" name="otp" placeholder="Enter Your OPT" ></div>
                                      <div class="col-4">
                                          <button class="custome-icon-btn-primary"   id="otp-send-btn">
                                              <span class="text">OTP</span>
                                          </button>
                                      </div>
                                  </div>
                                  <button class="custome-icon-btn-primary" id="submit-btn">
                                      <span class="text">Submit</span>
                                  </button>
                              </div>
                          </div>
                      </div>
                  </form>
      
              </div>
      
              <div id="acc-details" class="nav-page" data-page="acc-details">
                  <h5><u>Account & GST Details:</u></h5>
      
                  <div class="col-6 gst-pan-wrapper">
                      <div class="row">
                          <div class="col-6">
                              <span class="ac-heading">GSTIN No.:</span>
                              <span class="text-keys" data-key="gstn.no"></span>
                              <span class="edit"> <i class="fa-solid fa-pen-to-square"></i></span>
                          </div>
                          <div class="col-6">
                              <span class="ac-heading">PAN Card NO.: </span>
                              <span class="text-keys" data-key="pan.crd"></span>
                          </div>
                      </div>
                  </div>
  
                  <div class="shadow-div mt-3">
  
                  </div>
  
                  <div class="row" style="width: 100%;">
                      <div class="col-12">    
                          <div class="row">
                              <div class="col-lg-6">
                                  <div class="row">
                                      <div class="col-lg-6">
                                          <p class="text-right">Account Holder Name : </p>
                                      </div>
                                      <div class="col-lg-6"><span class="text-keys" data-key="accnt.nm"></span></div>
                                  </div>
                              </div>
                              <div class="col-lg-6">
                                  <div class="row">
                                      <div class="col-lg-6">
                                          <p class="text-right">Account NO.: </p>
                                      </div>
                                      <div class="col-lg-6"><span class="text-keys" data-key="accnt.no"></span></div>
                                  </div>
                              </div>
                              <div class="col-lg-6">
                                  <div class="row">
                                      <div class="col-lg-6">
                                          <p class="text-right">IFSC Code : </p>
                                      </div>
                                      <div class="col-lg-6"><span class="text-keys" data-key="ifsc"></span></div>
                                  </div>
                              </div>
                              <div class="col-lg-6">
                                  <div class="row">
                                      <div class="col-lg-6">
                                          <p class="text-right">Bank Name. : </p>
                                      </div>
                                      <div class="col-lg-6"><span class="text-keys" data-key="bnk.nm"></span></div>
                                  </div>
                              </div>
                              <div class="col-12"><hr></div>
                          </div>
                      </div>
                  </div>
                  
                  <p class=""><span class="badge badge-primary form-badge">Update GSTIN</span></p>
                  <form id="update-gstin-form" class="needs-validation mb-2" novalidate>
                      <div class="row input-box update-gstin-details" style="display: none;">
                          <div class="col-12"><hr></div>
                          <div class="col-8">
                              <div class="row">
                                  <div class="col-6">
                                      <div class="input-group mb-3">
                                          <input type="text" class="form-control" placeholder="Enter GSTIN" aria-label="Enter GSTIN" name="gstn.no" id="gstin-no-input"aria-describedby="gstin-no-input" required>
                                          <span class="input-group-text bg-danger text-white" >Verify</span>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <input type="file" class="form-control" name="gst.doc" required>
                                  </div>
                              </div>
                          </div>
                          <div class="col-6"><button class="btn btn-primary btn-lg">Send Update Request</button></div>
                      </div>
                  </form>
      
                  <p class=""><span class="badge badge-primary form-badge">Update Account Details</span></p>
                  <form id="update-account-form" class="needs-validation" novalidate>
                      <div class="row input-box update-account-details">
                          <div class="col-12"><hr></div>
                          <div class="col-8">
                              <div class="row">
                                  <div class="col-7">
                                      <div class="mb-3">
                                          <label for="holdernm" class="form-label">Account Holder Name</label>
                                          <input type="text" class="form-control " id="holdernm" name="accnt.nm" required>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="mb-3">
                                          <label for="backaccntno" class="form-label">Bank Account No</label>
                                          <input type="text" class="form-control " id="backaccntno" name="accnt.no" maxlength="50"  required>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="mb-3">
                                          <label for="re-backaccntno" class="form-label">Re-Enter  Account No</label>
                                          <input type="text" class="form-control " id="re-backaccntno" required>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="mb-3">
                                          <label for="ifsc" class="form-label">IFSC Code.</label>
                                          <div class="row">
                                              <div class="col-9">
                                                  <input type="text" class="form-control required" id="ifsc" name="ifsc" maxlength="11" required>
                                              </div>
                                              <div class="col-3">
                                                  <span class="btn btn-sm btn-success" style="width: 100%;" id="verify_ifsc-btn">Verify</span>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <div class="mb-3">
                                          <label for="banknm" class="form-label">Bank Name</label>
                                          <input type="text" class="form-control required" id="banknm" name="bnk.nm" required>
                                      </div>
                                  </div>
                                  <div class="col-6">
                                      <label for="cancel_cheque">Upload Scanned Cancel Cheque:</label>
                                      <div class="input-group">
                                          <input required  type="file" id="cancel_cheque" accept=".pdf,.png,.jpg,.jpeg"  name="cancel.cheque.doc" class="form-control required" >
                                          <label class="input-group-text file-refresh-icon" >
                                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                                  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                                  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                                              </svg>
                                          </label>
                                      </div>
                                  </div>
                                  <div class="col-12"><button class="btn btn-primary btn-lg mt-2">Send Update Request</button></div>
                              </div>
                          </div>
                      </div>
                  </form>
      
              </div>
      
              <div id="setting" class="nav-page" data-page="setting">
                  <h5><u>Setting /Convert Registration:</u></h5>
                  <span class="text-success" id="check-status" style="cursor: pointer;"><u>View Payment Status</u></span>
                  <div class="row mt-2">
                      <div class="col-12">
                          <div class="form-check">
                              <input class="form-check-input" type="checkbox" value="" id="checkactions">
                              <label class="form-check-label text-primary" for="checkactions">
                                  I am all ready cleared my all portal purchased material balance payements & I also ready to Convert/Deactivate my registration type.
                              </label>
                          </div>
                      </div>
                      <div class="col-12 mt-2">
                          <p>
                              Individual To <select id="select-convert-type">
                                  <option value="F">Firm</option>
                              </select>
                              <button class="btn btn-primary " id="convert-view-btn" disabled>Convert And View</button>
                              <button class="btn btn-danger " id="deactivate-btn" disabled>Deactivate</button>
                          </p>
                      </div>
                      <div class="col-12 mt-2"><hr></div>
                      <div class="col-12" id="table-wrapper">
                          <table class="table table-bordered border-primary">
                              <thead class="text-center">
                                  <tr>
                                      <th>Remarks</th>
                                      <th>Request Date And Time</th>
                                      <th>Action Date</th>
                                      <th>Status</th>
                                      <th>View</th>
                                  </tr>
                              </thead>
                              <tbody class="text-center">
                                  <tr>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                  </tr>
                                  <tr>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                  </tr>
                                  <tr>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                  </tr>
                                  <tr>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                  </tr>
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>
      
              <div id="upld-docs" class="nav-page" data-page="upld-docs">
                  <h5><u>Uploaded Documents:</u></h5>
              </div>
          </div>
      
      
          <!-- Payment Popup -->
          <!-- <div id="payment-popup">
              <div>
                  <div class="header">
                      Payment Status
                      <div class="hr"></div>
                  </div>
                  <div class="content-wrapper">
                      <div class="row">
                          <div class="col-10 m-auto table-wrapper">
                              <table class="table table-bordered">
                                  <thead class="text-center">
                                      <tr>
                                          <th>Portal Name</th>
                                          <th>Total Purchased Amount</th>
                                          <th>Total Paid Amount</th>
                                          <th>Totla Balance Amount</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                                      <tr>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                      </tr>
                                      <tr>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                      </tr>
                                      <tr>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                      </tr>
                                      <tr>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                      </tr>
      
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              </div>
          </div> -->
          <!-- End Payment Popup -->
          
      </section>
      
      
      <form id="download-form" action="http://78.47.157.146:8080/usermanage/api/docdwnld">
          <input type="hidden" name="FILE.NM" id="file_nm" value="">
              <input type="hidden" name="PR.NO" id="pr_input" value="">
          <input type="hidden" name="ACT" value="P">
      </form>
  
  </div>